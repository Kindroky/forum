<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoL</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <header>
            <img src="/static/FoL-Logo.png" alt="Forum Name">
            <div class="post-button-container">
                {{ if .Authenticated }}
                    <button onclick="window.location.href='/addpost'" class="create-post-button">
                        <img src="/static/challenger.png" alt="Create Icon"> Create Post
                    </button>
                {{ else }}
                    <button onclick="window.location.href='/login'" class="create-post-button">
                        <img src="/static/challenger.png" alt="Log In Icon"> Log In to Create Post
                    </button>
                {{ end }}
            </div>
            <!-- Navigation Buttons -->
            <div class="navigation-buttons">
                <a href="/likedposts" class="nav-button">Liked Posts</a>
                <a href="/createdposts" class="nav-button">Created Posts</a>
            </div>
        </header>

        <!-- Main Layout -->
        <main class="main-layout">
            <!-- Sidebar for Categories -->
            <aside class="sidebar">
                <h3>Categories</h3>
                <div class="category-buttons">
                    <button onclick="window.location.href='/?category=items'">Items</button>
                    <button onclick="window.location.href='/?category=champs'">Champs</button>
                    <button onclick="window.location.href='/?category=meta'">Meta</button>
                    <button onclick="window.location.href='/?category=events'">Events</button>
                </div>                
            </aside>

            <!-- Home Icon -->
            <div class="home-icon">
                <a href="/">
                    <img src="/static/FoL-ICON.png" alt="Forum Icon">
                </a>
            </div>

            <!-- Feed Section -->
            <section class="feed">
                <div class="welcome-message">
                    Welcome to the land of totally unbiased takes. Become a legend and share your 200 IQ meta predictions and champion sob stories! Theory craft some questionable builds or dissect events like you're a pro analyst! The community is ready to agree, or flame you once again...
                </div>

                <!-- Render Posts -->
                {{ if .Posts }}
                    {{ range .Posts }}
                        <div class="post">
                            <a href="/detailpost?id={{.ID}}">
                                <!-- Post Header -->
                                <div class="post-header">
                                    <h2>{{ .Title }}</h2>
                                    <div class="post-user-info">
                                        <p><strong>{{ if .User.Username }}{{ .User.Username }}{{ else }}Unknown User{{ end }}</strong></p>
                                        <p>Rank: 
                                            <span class="rank-highlight {{ if eq .User.Rank "Iron" }}rank-iron{{ else if eq .User.Rank "Bronze" }}rank-bronze{{ else if eq .User.Rank "Silver" }}rank-silver{{ end }}">
                                                {{ if .User.Rank }}{{ .User.Rank }}{{ else }}Unranked{{ end }}
                                            </span>
                                        </p>
                                    </div>
                                </div>
                                <!-- Post Content -->
                                <div class="post-content">
                                    <p>{{ .Content }}</p>
                                </div>
                            </a>
                            <!-- Post Footer -->
                            <hr class="post-divider">
                            <div class="post-footer">
                                {{ if $.Authenticated }}
                                    <form action="/like" method="POST" class="like-form">
                                        <input type="hidden" name="postID" value="{{ .ID }}">
                                        <input type="hidden" name="likeType" value="1">
                                        <button type="submit" class="like-button">ðŸ”º {{ .LikesCount }}</button>
                                    </form>
                                    <form action="/like" method="POST" class="dislike-form">
                                        <input type="hidden" name="postID" value="{{ .ID }}">
                                        <input type="hidden" name="likeType" value="-1">
                                        <button type="submit" class="dislike-button">ðŸ”» {{ .DislikesCount }}</button>
                                    </form>
                                    <button class="comment-button" onclick="window.location.href='/post/?ID={{.ID}}'">ðŸ’¬ </button>
                                {{ else }}
                                    <p>Please <a href="/login">log in</a> to interact with posts.</p>
                                {{ end }}
                            </div>                            
                        </div>
                    {{ end }}
                {{ else }}
                    <p>No posts available. Be the first to create one!</p>
                {{ end }}
            </section>

            <!-- Profile Sidebar -->
            <aside class="profile-sidebar">
                {{ if .Authenticated }}
                    <div class="profile-box">
                        <h3>{{ if .User.Username }}{{ .User.Username }}{{ else }}Unknown User{{ end }}</h3>
                        <p class="lp-display">LP: {{ .User.LP }}</p>
                        <p class="rank-display">Rank: 
                            <span class="rank-highlight {{ if eq .User.Rank "Iron" }}rank-iron{{ else if eq .User.Rank "Bronze" }}rank-bronze{{ else if eq .User.Rank "Silver" }}rank-silver{{ end }}">
                                {{ .User.Rank }}
                            </span>
                        </p>
                        <a href="/logout" class="logout-button">Log Out</a>
                    </div>
                {{ else }}
                    <div class="profile-box">
                        <h3>Welcome, Guest!</h3>
                        <p><a href="/login">Log in</a> or <a href="/register">register</a> to join the community.</p>
                    </div>
                {{ end }}
            </aside>
        </main>
    </div>
</body>
</html>
